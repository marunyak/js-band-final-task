(this["webpackJsonpjs-band-final-task"]=this["webpackJsonpjs-band-final-task"]||[]).push([[0],{26:function(e,t,a){e.exports=a.p+"static/media/shopping-cart.b3066055.png"},36:function(e,t,a){e.exports=a.p+"static/media/defaultPhoto.b1c4e6fe.jpg"},40:function(e,t,a){e.exports=a(52)},50:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(24),l=a.n(c),o=a(3),i=a(19),s=a(20),u=a(37),m=a(34),p=a(12),d=Object(p.b)(),b=a(4),h=a(5),f=a(6),v=new(function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"get",value:function(e){return localStorage.getItem(e)}},{key:"add",value:function(e,t){localStorage.setItem(e,JSON.stringify(t))}},{key:"remove",value:function(e){localStorage.removeItem(e)}}]),e}()),E={username:"",avatar:"",token:""},g={search:"",price:"none"},O=a(23),y={books:[],loading:!1,error:!1},j={id:void 0,title:void 0,author:void 0,level:void 0,description:void 0,cover:void 0,tags:void 0,isLoading:!0,loaded:!1,error:null},k={books:[],message:void 0},N=Object(s.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"SIGN_IN":var r=Object(b.a)({},e,{username:n.username,avatar:n.avatar,token:n.token});return r;case"CHECK_SIGN":var c=v.get("user");return c?(c=JSON.parse(c),Object(b.a)({},e,{},c)):e;case"SIGN_OUT":return v.remove("user"),Object(b.a)({},e,{},E);default:return e}},catalog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"FETCH_BOOKS":return Object(b.a)({},e,{loading:!0});case"FETCH_BOOKS_SUCCESS":return Object(b.a)({},e,{books:Object(O.a)(n),loading:!1});case"FETCH_BOOKS_FAIL":return Object(b.a)({},e,{error:t.error,loading:!1});default:return e}},book:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"LOAD_BOOK_SUCCESS":return Object(b.a)({},e,{},n,{isLoading:!1});case"LOAD_BOOK_FAIL":return Object(b.a)({},e,{error:n.err,isLoading:!1});default:return e}},filter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"CHANGE_FILTER":return Object(b.a)({},e,{},n.newValue);default:return e}},cart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"ADD_BOOK":var r=!1;if(e.books.length>0){var c=e.books.map((function(e){return e.id===n.newValue.id&&(r=!0,e=Object(b.a)({},e,{count:n.newValue.count})),e}));return r?Object(b.a)({},e,{books:c}):Object(b.a)({},e,{books:[].concat(Object(O.a)(e.books),[n.newValue])})}return Object(b.a)({},e,{books:[].concat(Object(O.a)(e.books),[n.newValue])});case"PURCHASE_SUCCESS":return console.log(n.message),Object(b.a)({},k,{message:n.message});case"PURCHASE_FAIL":return console.log(n.message),Object(b.a)({},e,{message:n.message,loading:!1});default:return e}},router:Object(i.b)(d)}),S=Object(s.a)(m.a,Object(u.a)(d)),C=Object(s.d)(N,S),x=a(13),w=a(15),_=a(9),A=a(8),T=a(10),F=a(26),L=a.n(F),B=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(_.a)(this,(e=Object(A.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){(0,a.props.signOut)()},a}return Object(T.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.username,a=e.avatar;return r.a.createElement("div",{className:"d-flex justify-content-between align-items-center nav"},r.a.createElement("div",{className:"nav-item mr-4"},r.a.createElement(x.b,{to:"/cart"},r.a.createElement("img",{src:L.a,alt:"",style:{width:"50px",height:"50px",cursor:"pointer"}}))),r.a.createElement("div",{className:"nav-item mr-4"},r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary",onClick:this.handleClick},"Sign-Out")),r.a.createElement("div",{className:"nav-item mr-4"},r.a.createElement("img",{src:a,alt:"",className:"rounded-circle",style:{width:"50px",height:"50px"}})),r.a.createElement("div",{className:"nav-item mr-4"},r.a.createElement("span",null,t)))}}]),t}(r.a.Component),U=Object(o.c)((function(e){var t=e.user;return{username:t.username,avatar:t.avatar}}),(function(e){return{signOut:function(){return e({type:"SIGN_OUT"})}}}))(B);var I=Object(o.c)((function(e){return{user:e.user}}))((function(e){var t=e.children,a=e.user,n="JS BAND STORE/ Andrii Maruniak";return r.a.createElement("header",{className:"d-flex justify-content-between align-items-center p-3 bg-warning text-white"},r.a.createElement("div",{style:{cursor:"pointer"}},a.token?r.a.createElement(x.b,{className:"text-white",to:"/books"},n):r.a.createElement(x.b,{className:"text-white",to:"/signin"},n)),t)}));var P=function(e){var t=e.children;return r.a.createElement("main",null,t)},H=(a(50),function(){return r.a.createElement("div",{className:"l_main"},r.a.createElement("div",{className:"l_square"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),r.a.createElement("div",{className:"l_square"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),r.a.createElement("div",{className:"l_square"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),r.a.createElement("div",{className:"l_square"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)))});var D=function(e){var t=e.book;return r.a.createElement("div",{className:"book col-sm-3 shadow rounded p-3 mr-3 mb-4 bg-white position -relative text-black",style:{height:"400px"}},r.a.createElement("div",{className:"img-block mb-2"},r.a.createElement("img",{src:t.cover,alt:"",style:{width:"100%",height:"190px"}})),r.a.createElement("h6",{className:"title",style:{height:"48px"}},t.title),r.a.createElement("p",{className:"text text-break"},t.author),r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement("div",null,t.price," ","$"),r.a.createElement(x.b,{to:"/books/".concat(t.id)},r.a.createElement("button",{type:"button",className:"btn btn-sm btn-primary"},"View"))))},K=a(18),R=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(_.a)(this,(e=Object(A.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){var t=e.target,n=t.value,r=t.name;(0,a.props.changeFilter)(Object(K.a)({},r,n))},a}return Object(T.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("section",{className:"mt-4 container"},r.a.createElement("form",{className:"filter d-flex",method:"#"},r.a.createElement("div",{className:"item"},r.a.createElement("input",{onChange:this.handleChange,type:"text",name:"search",className:"form-control mr-5",style:{width:"400px"},placeholder:"Search by title"})),r.a.createElement("div",{className:"item"},r.a.createElement("select",{onChange:this.handleChange,name:"price",className:"form-control"},r.a.createElement("option",{value:"none"},"Price"),r.a.createElement("option",{value:"low_price"},"0 \u2039 Price \u2039 15"),r.a.createElement("option",{value:"medium_price"},"15 \u2039 Price \u2039 30"),r.a.createElement("option",{value:"high_price"},"Price \u203a 30")))))}}]),t}(r.a.Component),V=Object(o.c)(null,{changeFilter:function(e){return{type:"CHANGE_FILTER",payload:{newValue:e}}}})(R),G=a(7),J={baseURL:"https://js-band-api.glitch.me/"},q=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(_.a)(this,(e=Object(A.a)(t)).call.apply(e,[this].concat(r)))).filter=function(){var e=a.props,t=e.books,n=e.search,r=e.price;return t.filter((function(e){return""===n||-1!==e.title.toLowerCase().search(new RegExp("^".concat(n.toLowerCase()),"g"))})).filter((function(e){return a.priceTypes(r,e.price)}))},a.priceTypes=function(e,t){return{none:t,low_price:t>0&&t<15,medium_price:t>15&&t<30,high_price:t>30}[e]},a}return Object(T.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.getBooksFetch)()}},{key:"render",value:function(){var e=this.props,t=e.loading,a=e.error,n=this.filter(),c=!(t||a)?n.map((function(e){return r.a.createElement(D,{book:e,key:e.id})})):null;return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,null,r.a.createElement(U,null)),r.a.createElement(P,null,r.a.createElement(V,null),r.a.createElement("div",{className:"books-list d-flex flex-wrap justify-content-center mt-5"},t?r.a.createElement(H,null):null,!t&&a&&"Error ...",c)))}}]),t}(r.a.Component),z=Object(w.g)(Object(o.c)((function(e){return{books:e.catalog.books,loading:e.catalog.loading,error:e.catalog.error,search:e.filter.search,price:e.filter.price}}),(function(e){return{getBooksFetch:function(){return e({type:"FETCH_BOOKS"}),e((function(e){var t=JSON.parse(v.get("user")).token;t&&fetch("".concat(J.baseURL,"books"),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(t){e({type:"FETCH_BOOKS_SUCCESS",payload:t})})).catch((function(t){"Unauthorized"===t.message?(v.remove("user"),e(Object(G.c)("/signin"))):e({type:"FETCH_BOOKS_FAIL",error:t})}))}))}}}))(q));a(51);var M=function(){return r.a.createElement("div",{id:"notfound"},r.a.createElement("div",{className:"notfound"},r.a.createElement("div",{className:"notfound-404"},r.a.createElement("h1",null,"404")),r.a.createElement("h2",null,"Oops, The Page you are looking for can't be found!")))},$=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(_.a)(this,Object(A.a)(t).call(this,e))).handleChange=function(e){var t,n=e.target,r=n.name,c=n.value;if(c>a.props.book.count){var l=a.state.temp;a.setState(Object(K.a)({},r,l)),a.input.value=l}else a.setState((t={},Object(K.a)(t,r,c),Object(K.a)(t,"temp",c),t))},a.handleSubmit=function(e){e.preventDefault();var t=a.props,n=t.book,r=n.id,c=n.title,l=n.price;(0,t.addToCart)({id:r,title:c,price:l,count:a.state.countBooks})},a.state={temp:1,countBooks:"1"},a}return Object(T.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.state.countBooks,a=this.props.book,n=a.price,c=a.count;return r.a.createElement("div",{className:"m-3 position-relative",style:{width:"600px",height:"400px",borderStyle:"dotted",borderWidth:2,borderRadius:1}},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"price d-flex justify-content-between m-4"},r.a.createElement("div",{className:"price-item"},r.a.createElement("h5",null,"Price, $")),r.a.createElement("div",{className:"price-item"},r.a.createElement("h5",null,n))),r.a.createElement("div",{className:"price d-flex justify-content-between m-4"},r.a.createElement("div",{className:"price-item"},r.a.createElement("h5",null,"Count")),r.a.createElement("div",{className:"price-item"},r.a.createElement("input",{onChange:this.handleChange,className:"form-control",name:"countBooks",type:"number",min:"1",max:c,defaultValue:t,ref:function(t){e.input=t},required:!0}))),r.a.createElement("div",{className:"total-price d-flex justify-content-between m-4"},r.a.createElement("div",{className:"price-item"},r.a.createElement("h5",null,"Total price")),r.a.createElement("div",{className:"price-item"},r.a.createElement("h5",null,(t>1?t*n:n).toFixed(2)))),r.a.createElement("button",{className:"btn btn-lg btn-primary position-absolute",style:{right:"20px",bottom:"40px"},type:"submit"},"Add to cart")))}}]),t}(r.a.Component),W=Object(o.c)(null,{addToCart:function(e){return{type:"ADD_BOOK",payload:{newValue:e}}}})($);var Q=Object(o.c)((function(e){return{book:e.book}}))((function(e){var t=e.book;return t.isLoading?r.a.createElement(H,null):!t.isLoading&&t.error?"Error ...":!!t.id&&r.a.createElement("div",{className:"d-flex m-3"},r.a.createElement("div",{className:"image-item mr-5",style:{width:"460px"}},r.a.createElement("img",{src:t.cover,alt:t.title,className:"mb-2 border",style:{width:"460px"}}),r.a.createElement("p",null,"Description:",t.description)),r.a.createElement("div",{className:"desc",style:{width:"400px"}},r.a.createElement("div",{className:"title mb-3 pt-4"},r.a.createElement("h3",null,t.title)),r.a.createElement("div",{className:"title mb-3"},"Author:"," ",t.author),r.a.createElement("div",{className:"level mb-3"},"Level:"," ",t.level),r.a.createElement("div",{className:"tags mb-2"},"Tags:"," ",t.tags.map((function(e){return e})).join(", "))),r.a.createElement(W,{book:t}))})),X=function(e){function t(){return Object(h.a)(this,t),Object(_.a)(this,Object(A.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this.props;(0,e.getBookFetch)(e.match.params.id)}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,null,r.a.createElement(U,null)),r.a.createElement(P,null,r.a.createElement(Q,null)))}}]),t}(r.a.Component),Y=Object(w.g)(Object(o.c)(null,{getBookFetch:function(e){return function(t){var a=JSON.parse(v.get("user")).token;a&&fetch("".concat(J.baseURL,"books/").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(a)}}).then((function(e){return e.json()})).then((function(e){t(function(e){return{type:"LOAD_BOOK_SUCCESS",payload:e}}(e))})).catch((function(e){"Unauthorized"===e?(v.remove("user"),t(Object(G.c)("/signin"))):t(function(e){return{type:"LOAD_BOOK_FAIL",payload:e}}(e))}))}}})(X));var Z=function(){return r.a.createElement("div",{className:"cart-empty text-center",style:{width:"200px",height:"250px",margin:"0 auto",paddingTop:"200px"}},r.a.createElement("img",{src:L.a,alt:"",style:{width:"120px",height:"150px"}}),r.a.createElement("p",null,"Cart is empty..."))};var ee=function(e){var t=e.info;return r.a.createElement("div",{className:"cart-item d-flex justify-content-between align-items-center border p-4"},r.a.createElement("div",{className:"item d-flex justify-content-between"},r.a.createElement("div",{className:"cart-title mr-3"},t.title),r.a.createElement("div",{className:"cart-count"},"Count:"," ",t.count)),r.a.createElement("div",{className:"item"},"Total price:"," ",t.count*t.price,"$"))},te=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(_.a)(this,(e=Object(A.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault();var t=a.props;(0,t.addPurchase)({books:t.cart.books.map((function(e){return e.id}))})},a}return Object(T.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.cart;return r.a.createElement("div",{className:"cart-list position-relative mt-3"},r.a.createElement("div",{className:"d-flex flex-row-reverse"},r.a.createElement("button",{type:"button",className:"btn  btn-primary mr-4",onClick:this.handleSubmit,disabled:e.books.length<1},"Purchase")),e.books.length<1?r.a.createElement(Z,null):r.a.createElement("div",{className:"m-2"},e.books.map((function(e){return r.a.createElement(ee,{key:e.id,info:e})})),r.a.createElement("div",{className:"total-price-item d-flex flex-row-reverse mt-2"},r.a.createElement("div",null,r.a.createElement("h5",null,"Total Price, $"," ",e.books.length>0?e.books.reduce((function(e,t){return e+t.count*t.price}),0):null)))))}}]),t}(r.a.Component),ae=Object(o.c)((function(e){return{cart:e.cart}}),{addPurchase:function(e){return function(t){var a=JSON.parse(v.get("user")).token;a&&fetch("".concat(J.baseURL,"purchase"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){t({type:"PURCHASE_SUCCESS",payload:e})})).catch((function(e){t(function(e){return{type:"PURCHASE_SUCCESS",payload:e}}(e))}))}}})(te);var ne=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,null,r.a.createElement(U,null)),r.a.createElement(P,null,r.a.createElement(ae,null)))};var re=Object(o.c)((function(e){return{userToken:e.user.token}}))((function(e){return e.userToken?r.a.createElement(r.a.Fragment,null,r.a.createElement(w.d,null,r.a.createElement(w.a,{from:"/signin",to:"/books"}),r.a.createElement(w.b,{path:"/books/:id",component:Y}),r.a.createElement(w.b,{path:"/books",component:z}),r.a.createElement(w.b,{path:"/cart",component:ne}),r.a.createElement(w.b,{path:"*",component:M}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{to:"/signin"}))})),ce=a(36),le=a.n(ce),oe=function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(_.a)(this,(e=Object(A.a)(t)).call.apply(e,[this].concat(r)))).handleValidation=function(e){var t=e.length,n=a.error;return n.innerHTML="",!(!a.input.value||t<4||t>16)||(n.innerHTML="Field is not valid",!1)},a.handleSubmit=function(e){e.preventDefault();var t=a.props.login,n=a.input.value;a.handleValidation(n)&&t(n)},a}return Object(T.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,null),r.a.createElement(P,null,r.a.createElement("div",{className:"d-flex justify-content-center mt-5"},r.a.createElement("div",{className:"text-center"},r.a.createElement("img",{src:le.a,alt:"",style:{height:"200px",width:"200px"}}),r.a.createElement("form",null,r.a.createElement("div",{className:"form-group mt-3"},r.a.createElement("label",{htmlFor:"username",style:{display:"block"},className:"font-weight-bold"},"Username",r.a.createElement("input",{type:"text",name:"username",className:"form-control mt-2",placeholder:"type Username",ref:function(t){e.input=t},required:!0}),r.a.createElement("div",{className:"error text-danger text-break text-center",ref:function(t){e.error=t}})),r.a.createElement("div",{className:"btn btn-block btn-primary mt-3",style:{cursor:"pointer"},onClick:function(t){return e.handleSubmit(t)}},"Sign-In")))))))}}]),t}(r.a.Component),ie=Object(w.g)(Object(o.c)(null,(function(e){return{login:function(t){return e((a=t,function(e){fetch("".concat(J.baseURL,"/signin"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:a})}).then((function(e){return e.json()})).then((function(t){v.add("user",t),e({type:"SIGN_IN",payload:t}),e(Object(G.c)("/books"))}))}));var a}}}))(oe));var se=Object(o.c)(null,{checkSign:function(){return{type:"CHECK_SIGN"}}})((function(e){return(0,e.checkSign)(),r.a.createElement(x.a,null,r.a.createElement(w.d,null,r.a.createElement(w.b,{path:"/signin",component:ie}),r.a.createElement(w.b,{component:re})))}));l.a.render(r.a.createElement(o.a,{store:C},r.a.createElement(i.a,{history:d},r.a.createElement(se,null))),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.51909cf3.chunk.js.map